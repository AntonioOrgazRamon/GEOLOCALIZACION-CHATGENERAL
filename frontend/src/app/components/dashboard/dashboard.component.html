<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Geolocation App</h1>
    <div class="user-info">
      <span>Welcome, {{ user?.name }}</span>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
  </div>

  <div class="dashboard-content">
    <div class="location-section">
      <h2>Mi Ubicaci贸n</h2>
      <div *ngIf="loadingLocation" class="loading-status">
        <p> Obteniendo tu ubicaci贸n...</p>
      </div>
      <div *ngIf="locationSet && !loadingLocation" class="location-info">
        <p><strong>Latitude:</strong> {{ latitude }}</p>
        <p><strong>Longitude:</strong> {{ longitude }}</p>
      </div>
      <div *ngIf="!locationSet && !loadingLocation" class="no-location">
        <p>Esperando ubicaci贸n...</p>
      </div>
    </div>

    <div class="search-section">
      <h2>Usuarios Cercanos (5 km)</h2>
      <div *ngIf="locationSet" class="search-info">
        <p>B煤squeda autom谩tica activa</p>
        <div class="countdown-container">
          <span class="countdown-label">Pr贸xima actualizaci贸n en:</span>
          <span class="countdown-value">{{ countdown }}s</span>
        </div>
      </div>
    </div>

    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <!-- Contenedor siempre presente para evitar layout shift -->
    <div class="users-list" [class.has-users]="nearbyUsers.length > 0">
      <h2 *ngIf="nearbyUsers.length > 0">Usuarios Cercanos ({{ nearbyUsers.length }})</h2>
      <div *ngIf="nearbyUsers.length > 0" class="users-grid">
        <div *ngFor="let user of nearbyUsers" class="user-card">
          <h3>{{ user.name }}</h3>
          <p class="email">{{ user.email }}</p>
          <p class="distance">Distancia: {{ user.distance_km }} km</p>
        </div>
      </div>
      <div *ngIf="nearbyUsers.length === 0 && locationSet" class="no-users">
        <p>No se encontraron usuarios cercanos en un radio de 5 km.</p>
      </div>
    </div>
  </div>

  <!-- Chat section fuera del grid para que siempre se muestre -->
  <div class="chat-section">
    <app-chat></app-chat>
  </div>
</div>
